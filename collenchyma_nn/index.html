<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="rustdoc">
    <meta name="description" content="API documentation for the Rust `collenchyma_nn` crate.">
    <meta name="keywords" content="rust, rustlang, rust-lang, collenchyma_nn">

    <title>collenchyma_nn - Rust</title>

    <link rel="stylesheet" type="text/css" href="../rustdoc.css">
    <link rel="stylesheet" type="text/css" href="../main.css">

    
    
</head>
<body class="rustdoc">
    <!--[if lte IE 8]>
    <div class="warning">
        This old browser is unsupported and will most likely display funky
        things.
    </div>
    <![endif]-->

    

    <nav class="sidebar">
        
        <p class='location'></p><script>window.sidebarCurrent = {name: 'collenchyma_nn', ty: 'mod', relpath: '../'};</script>
    </nav>

    <nav class="sub">
        <form class="search-form js-only">
            <div class="search-container">
                <input class="search-input" name="search"
                       autocomplete="off"
                       placeholder="Click or press ‘S’ to search, ‘?’ for more options…"
                       type="search">
            </div>
        </form>
    </nav>

    <section id='main' class="content mod">
<h1 class='fqn'><span class='in-band'>Crate <a class='mod' href=''>collenchyma_nn</a></span><span class='out-of-band'><span id='render-detail'>
            <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">
                [<span class='inner'>&#x2212;</span>]
            </a>
        </span><a id='src-0' class='srclink' href='../src/collenchyma_nn/lib.rs.html#1-125' title='goto source code'>[src]</a></span></h1>
<div class='docblock'><p>Provides a <a href="https://github.com/autumnai/collenchyma">Collenchyma</a> Plugin, to extend Collenchyma with Neural Network related
operations such as convolutions, pooling, ReLU, etc. A full list of operations provided by this Plugin,
can be found at the <a href="#operations">provided Operations section</a>.</p>

<h2 id='overview' class='section-header'><a href='#overview'>Overview</a></h2>
<p>This Collenchyma Plugin extends Collenchyma&#39;s Backend with NN related methods/operations. This allows
you to run, these operations (and therefore your application) on your local machine as well as on servers,
mobiles or any other machine (as if they were written for common CPU execution), while
receiving the significant performance increases (usually one-to-two orders of magnitutde), by
executing the operations on special purpose hardware such as GPUs - if they are available. Usage examples
can be found in the next section.</p>

<p>The architecture of a Plugin is quite easy. It defines one Plugin Trait, in this case the <code>NN</code>
trait, which implements basic functionality for initialization and multiple Plugin Operation Traits which define the
methods which are going to be available on the Backed, as the Plugin Trait as well as the Plugin Operations Traits
are implemented for the Collenchyma Backends (CUDA, OpenCL, Native). The operations take as arguments one or many
SharedTensors, holding the data over which the operation should happen, and none or one Operation Configuration.</p>

<h2 id='usage' class='section-header'><a href='#usage'>Usage</a></h2>
<p>An example on how to write some data into a SharedTensor and compute the result of the
sigmoid function for each value:</p>
<pre class='rust rust-example-rendered'>
<span class='kw'>extern</span> <span class='kw'>crate</span> <span class='ident'>collenchyma</span> <span class='kw'>as</span> <span class='ident'>co</span>;
<span class='kw'>extern</span> <span class='kw'>crate</span> <span class='ident'>collenchyma_nn</span> <span class='kw'>as</span> <span class='ident'>nn</span>;
<span class='kw'>use</span> <span class='ident'>co</span>::<span class='ident'>prelude</span>::<span class='op'>*</span>;
<span class='kw'>use</span> <span class='ident'>nn</span>::<span class='op'>*</span>;

<span class='kw'>fn</span> <span class='ident'>write_to_memory</span><span class='op'>&lt;</span><span class='ident'>T</span>: <span class='ident'>Copy</span><span class='op'>&gt;</span>(<span class='ident'>mem</span>: <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>MemoryType</span>, <span class='ident'>data</span>: <span class='kw-2'>&amp;</span>[<span class='ident'>T</span>]) {
    <span class='kw'>if</span> <span class='kw'>let</span> <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>MemoryType</span>::<span class='ident'>Native</span>(<span class='kw-2'>ref</span> <span class='kw-2'>mut</span> <span class='ident'>mem</span>) <span class='op'>=</span> <span class='ident'>mem</span> {
        <span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>mem_buffer</span> <span class='op'>=</span> <span class='ident'>mem</span>.<span class='ident'>as_mut_slice</span>::<span class='op'>&lt;</span><span class='ident'>T</span><span class='op'>&gt;</span>();
        <span class='kw'>for</span> (<span class='ident'>index</span>, <span class='ident'>datum</span>) <span class='kw'>in</span> <span class='ident'>data</span>.<span class='ident'>iter</span>().<span class='ident'>enumerate</span>() {
            <span class='ident'>mem_buffer</span>[<span class='ident'>index</span>] <span class='op'>=</span> <span class='op'>*</span><span class='ident'>datum</span>;
        }
    }
}

<span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>main</span>() {
    <span class='comment'>// Initialize a CUDA Backend.</span>
    <span class='comment'>// Usually you would not use CUDA but let Collenchyma pick what is available on the machine.</span>
    <span class='kw'>let</span> <span class='ident'>backend</span> <span class='op'>=</span> <span class='ident'>Backend</span>::<span class='op'>&lt;</span><span class='ident'>Cuda</span><span class='op'>&gt;</span>::<span class='ident'>default</span>().<span class='ident'>unwrap</span>();
    <span class='comment'>// Initialize two SharedTensors.</span>
    <span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>x</span> <span class='op'>=</span> <span class='ident'>SharedTensor</span>::<span class='op'>&lt;</span><span class='ident'>f32</span><span class='op'>&gt;</span>::<span class='ident'>new</span>(<span class='ident'>backend</span>.<span class='ident'>device</span>(), <span class='kw-2'>&amp;</span>(<span class='number'>1</span>, <span class='number'>1</span>, <span class='number'>3</span>)).<span class='ident'>unwrap</span>();
    <span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>result</span> <span class='op'>=</span> <span class='ident'>SharedTensor</span>::<span class='op'>&lt;</span><span class='ident'>f32</span><span class='op'>&gt;</span>::<span class='ident'>new</span>(<span class='ident'>backend</span>.<span class='ident'>device</span>(), <span class='kw-2'>&amp;</span>(<span class='number'>1</span>, <span class='number'>1</span>, <span class='number'>3</span>)).<span class='ident'>unwrap</span>();
    <span class='comment'>// Fill `x` with some data.</span>
    <span class='kw'>let</span> <span class='ident'>payload</span>: <span class='kw-2'>&amp;</span>[<span class='ident'>f32</span>] <span class='op'>=</span> <span class='kw-2'>&amp;</span>::<span class='ident'>std</span>::<span class='ident'>iter</span>::<span class='ident'>repeat</span>(<span class='number'>1f32</span>).<span class='ident'>take</span>(<span class='ident'>x</span>.<span class='ident'>capacity</span>()).<span class='ident'>collect</span>::<span class='op'>&lt;</span><span class='ident'>Vec</span><span class='op'>&lt;</span><span class='ident'>f32</span><span class='op'>&gt;&gt;</span>();
    <span class='kw'>let</span> <span class='ident'>native</span> <span class='op'>=</span> <span class='ident'>Native</span>::<span class='ident'>new</span>();
    <span class='kw'>let</span> <span class='ident'>cpu</span> <span class='op'>=</span> <span class='ident'>native</span>.<span class='ident'>new_device</span>(<span class='ident'>native</span>.<span class='ident'>hardwares</span>()).<span class='ident'>unwrap</span>();
    <span class='ident'>x</span>.<span class='ident'>add_device</span>(<span class='kw-2'>&amp;</span><span class='ident'>cpu</span>).<span class='ident'>unwrap</span>(); <span class='comment'>// Add native host memory</span>
    <span class='ident'>x</span>.<span class='ident'>sync</span>(<span class='kw-2'>&amp;</span><span class='ident'>cpu</span>).<span class='ident'>unwrap</span>(); <span class='comment'>// Sync to native host memory</span>
    <span class='ident'>write_to_memory</span>(<span class='ident'>x</span>.<span class='ident'>get_mut</span>(<span class='kw-2'>&amp;</span><span class='ident'>cpu</span>).<span class='ident'>unwrap</span>(), <span class='ident'>payload</span>); <span class='comment'>// Write to native host memory.</span>
    <span class='ident'>x</span>.<span class='ident'>sync</span>(<span class='ident'>backend</span>.<span class='ident'>device</span>()).<span class='ident'>unwrap</span>(); <span class='comment'>// Sync the data to the CUDA device.</span>
    <span class='comment'>// Run the sigmoid operation, provided by the NN Plugin, on your CUDA enabled GPU.</span>
    <span class='ident'>backend</span>.<span class='ident'>sigmoid</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>x</span>, <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>result</span>).<span class='ident'>unwrap</span>();
    <span class='comment'>// See the result.</span>
    <span class='ident'>result</span>.<span class='ident'>add_device</span>(<span class='kw-2'>&amp;</span><span class='ident'>cpu</span>).<span class='ident'>unwrap</span>(); <span class='comment'>// Add native host memory</span>
    <span class='ident'>result</span>.<span class='ident'>sync</span>(<span class='kw-2'>&amp;</span><span class='ident'>cpu</span>).<span class='ident'>unwrap</span>(); <span class='comment'>// Sync the result to host memory.</span>
    <span class='macro'>println</span><span class='macro'>!</span>(<span class='string'>&quot;{:?}&quot;</span>, <span class='ident'>result</span>.<span class='ident'>get</span>(<span class='kw-2'>&amp;</span><span class='ident'>cpu</span>).<span class='ident'>unwrap</span>().<span class='ident'>as_native</span>().<span class='ident'>unwrap</span>().<span class='ident'>as_slice</span>::<span class='op'>&lt;</span><span class='ident'>f64</span><span class='op'>&gt;</span>());
}</pre>

<h2 id='provided-operations' class='section-header'><a href='#provided-operations'>Provided Operations</a></h2>
<p>This Plugins provides the following operations. (Forward + Backward)
A <code>-</code> means not yet implemented.</p>

<table>
<thead>
<tr>
<th>Operation</th>
<th>CUDA</th>
<th>OpenCL</th>
<th>Native</th>
</tr>
</thead>

<tbody>
<tr>
<td>Sigmoid</td>
<td>cuDNN v3</td>
<td>-</td>
<td>Rust</td>
</tr>
<tr>
<td>SigmoidPointwise</td>
<td>cuDNN v3</td>
<td>-</td>
<td></td>
</tr>
<tr>
<td>ReLU</td>
<td>cuDNN v3</td>
<td>-</td>
<td>Rust</td>
</tr>
<tr>
<td>ReLUPointwise</td>
<td>cuDNN v3</td>
<td>-</td>
<td></td>
</tr>
<tr>
<td>Tanh</td>
<td>cudNN v3</td>
<td>-</td>
<td>Rust</td>
</tr>
<tr>
<td>TanhPointwise</td>
<td>cuDNN v3</td>
<td>-</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Normalization (LRN)</td>
<td>cudNN v3</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Convolution</td>
<td>cudNN v3</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Softmax</td>
<td>cudNN v3</td>
<td>-</td>
<td>Rust</td>
</tr>
<tr>
<td>LogSoftmax</td>
<td>cudNN v3</td>
<td>-</td>
<td>Rust</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Pooling Max</td>
<td>cudNN v3</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>Pooling Avg</td>
<td>cudNN v3</td>
<td>-</td>
<td>-</td>
</tr>
</tbody>
</table>
</div><h2 id='modules' class='section-header'><a href="#modules">Modules</a></h2>
<table>
                    <tr class=' module-item'>
                        <td><a class='mod' href='frameworks/index.html'
                               title='collenchyma_nn::frameworks'>frameworks</a></td>
                        <td class='docblock short'>
                             <p>Provides the specific Framework implementations for the Library Operations.</p>

                        </td>
                    </tr>
                </table><h2 id='macros' class='section-header'><a href="#macros">Macros</a></h2>
<table>
                    <tr class=' module-item'>
                        <td><a class='macro' href='macro.impl_ops_convolution_for!.html'
                               title='collenchyma_nn::impl_ops_convolution_for!'>impl_ops_convolution_for!</a></td>
                        <td class='docblock short'>
                             
                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='macro' href='macro.impl_ops_log_softmax_for!.html'
                               title='collenchyma_nn::impl_ops_log_softmax_for!'>impl_ops_log_softmax_for!</a></td>
                        <td class='docblock short'>
                             
                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='macro' href='macro.impl_ops_lrn_for!.html'
                               title='collenchyma_nn::impl_ops_lrn_for!'>impl_ops_lrn_for!</a></td>
                        <td class='docblock short'>
                             
                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='macro' href='macro.impl_ops_pooling_for!.html'
                               title='collenchyma_nn::impl_ops_pooling_for!'>impl_ops_pooling_for!</a></td>
                        <td class='docblock short'>
                             
                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='macro' href='macro.impl_ops_relu_for!.html'
                               title='collenchyma_nn::impl_ops_relu_for!'>impl_ops_relu_for!</a></td>
                        <td class='docblock short'>
                             
                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='macro' href='macro.impl_ops_sigmoid_for!.html'
                               title='collenchyma_nn::impl_ops_sigmoid_for!'>impl_ops_sigmoid_for!</a></td>
                        <td class='docblock short'>
                             
                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='macro' href='macro.impl_ops_softmax_for!.html'
                               title='collenchyma_nn::impl_ops_softmax_for!'>impl_ops_softmax_for!</a></td>
                        <td class='docblock short'>
                             
                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='macro' href='macro.impl_ops_tanh_for!.html'
                               title='collenchyma_nn::impl_ops_tanh_for!'>impl_ops_tanh_for!</a></td>
                        <td class='docblock short'>
                             
                        </td>
                    </tr>
                </table><h2 id='enums' class='section-header'><a href="#enums">Enums</a></h2>
<table>
                    <tr class=' module-item'>
                        <td><a class='enum' href='enum.ConvBackwardDataAlgo.html'
                               title='collenchyma_nn::ConvBackwardDataAlgo'>ConvBackwardDataAlgo</a></td>
                        <td class='docblock short'>
                             <p>Different algorithms to compute the gradient with respect to the filter.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='enum' href='enum.ConvBackwardFilterAlgo.html'
                               title='collenchyma_nn::ConvBackwardFilterAlgo'>ConvBackwardFilterAlgo</a></td>
                        <td class='docblock short'>
                             <p>Different algorithms to compute the gradient with respect to the filter.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='enum' href='enum.ConvForwardAlgo.html'
                               title='collenchyma_nn::ConvForwardAlgo'>ConvForwardAlgo</a></td>
                        <td class='docblock short'>
                             <p>Different algorithms to compute the convolution forward algorithm.</p>

                        </td>
                    </tr>
                </table><h2 id='traits' class='section-header'><a href="#traits">Traits</a></h2>
<table>
                    <tr class=' module-item'>
                        <td><a class='trait' href='trait.Convolution.html'
                               title='collenchyma_nn::Convolution'>Convolution</a></td>
                        <td class='docblock short'>
                             <p>Provides the functionality for a Backend to support Convolution operations.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='trait' href='trait.ConvolutionConfig.html'
                               title='collenchyma_nn::ConvolutionConfig'>ConvolutionConfig</a></td>
                        <td class='docblock short'>
                             <p>Provides Convolution Config functionality.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='trait' href='trait.LRN.html'
                               title='collenchyma_nn::LRN'>LRN</a></td>
                        <td class='docblock short'>
                             <p>Provides the functionality for a Backend to support Local Response Normalization operations.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='trait' href='trait.LogSoftmax.html'
                               title='collenchyma_nn::LogSoftmax'>LogSoftmax</a></td>
                        <td class='docblock short'>
                             <p>Provides the functionality for a Backend to support LogSoftmax operations.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='trait' href='trait.NN.html'
                               title='collenchyma_nn::NN'>NN</a></td>
                        <td class='docblock short'>
                             <p>Provides the functionality for a backend to support Neural Network related operations.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='trait' href='trait.NNOperationConfig.html'
                               title='collenchyma_nn::NNOperationConfig'>NNOperationConfig</a></td>
                        <td class='docblock short'>
                             <p>Provides generic NN Operation Config functionality.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='trait' href='trait.Pooling.html'
                               title='collenchyma_nn::Pooling'>Pooling</a></td>
                        <td class='docblock short'>
                             <p>Provides the functionality for a Backend to support Pooling operations.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='trait' href='trait.Relu.html'
                               title='collenchyma_nn::Relu'>Relu</a></td>
                        <td class='docblock short'>
                             <p>Provides the functionality for a Backend to support ReLU operations.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='trait' href='trait.ReluPointwise.html'
                               title='collenchyma_nn::ReluPointwise'>ReluPointwise</a></td>
                        <td class='docblock short'>
                             <p>Provides the functionality for pointwise ReLU operations (overwrites the input with the result of the operation).</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='trait' href='trait.Sigmoid.html'
                               title='collenchyma_nn::Sigmoid'>Sigmoid</a></td>
                        <td class='docblock short'>
                             <p>Provides the functionality for a Backend to support Sigmoid operations.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='trait' href='trait.SigmoidPointwise.html'
                               title='collenchyma_nn::SigmoidPointwise'>SigmoidPointwise</a></td>
                        <td class='docblock short'>
                             <p>Provides the functionality for pointwise Sigmoid operations (overwrites the input with the result of the operation).</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='trait' href='trait.Softmax.html'
                               title='collenchyma_nn::Softmax'>Softmax</a></td>
                        <td class='docblock short'>
                             <p>Provides the functionality for a Backend to support Softmax operations.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='trait' href='trait.Tanh.html'
                               title='collenchyma_nn::Tanh'>Tanh</a></td>
                        <td class='docblock short'>
                             <p>Provides the functionality for a Backend to support TanH operations.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='trait' href='trait.TanhPointwise.html'
                               title='collenchyma_nn::TanhPointwise'>TanhPointwise</a></td>
                        <td class='docblock short'>
                             <p>Provides the functionality for pointwise ReLU operations (overwrites the input with the result of the operation).</p>

                        </td>
                    </tr>
                </table></section>
    <section id='search' class="content hidden"></section>

    <section class="footer"></section>

    <aside id="help" class="hidden">
        <div>
            <h1 class="hidden">Help</h1>

            <div class="shortcuts">
                <h2>Keyboard Shortcuts</h2>

                <dl>
                    <dt>?</dt>
                    <dd>Show this help dialog</dd>
                    <dt>S</dt>
                    <dd>Focus the search field</dd>
                    <dt>&larrb;</dt>
                    <dd>Move up in search results</dd>
                    <dt>&rarrb;</dt>
                    <dd>Move down in search results</dd>
                    <dt>&#9166;</dt>
                    <dd>Go to active search result</dd>
                </dl>
            </div>

            <div class="infos">
                <h2>Search Tricks</h2>

                <p>
                    Prefix searches with a type followed by a colon (e.g.
                    <code>fn:</code>) to restrict the search to a given type.
                </p>

                <p>
                    Accepted types are: <code>fn</code>, <code>mod</code>,
                    <code>struct</code>, <code>enum</code>,
                    <code>trait</code>, <code>type</code>, <code>macro</code>,
                    and <code>const</code>.
                </p>

                <p>
                    Search functions by type signature (e.g.
                    <code>vec -> usize</code>)
                </p>
            </div>
        </div>
    </aside>

    

    <script>
        window.rootPath = "../";
        window.currentCrate = "collenchyma_nn";
        window.playgroundUrl = "";
    </script>
    <script src="../jquery.js"></script>
    <script src="../main.js"></script>
    
    <script defer src="../search-index.js"></script>
</body>
</html>